<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>پنل سوپرادمین | ویرایش رستوران</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" />
  <!-- Ionicons -->
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" />
  <!-- Theme style -->
  <link rel="stylesheet" href="../../dist/css/adminlte.min.css" />
  <!-- Google Font: Source Sans Pro -->
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet" />

  <!-- bootstrap rtl -->
  <link rel="stylesheet" href="../../dist/css/bootstrap-rtl.min.css" />
  <!-- template rtl version -->
  <link rel="stylesheet" href="../../dist/css/custom-style.css" />
</head>

<body class="hold-transition sidebar-mini">
  <div class="wrapper">

    <!-- Main Sidebar Container -->
    <aside class="main-sidebar sidebar-dark-primary elevation-4">
      <!-- Brand Logo -->
      <a href="/index.html" class="brand-link">
        <img src="/dist/img/logo3.png" alt="AdminLTE Logo" class="brand-image img-circle elevation-3"
          style="opacity: 0.8" />
        <span class="brand-text font-weight-light">پنل سوپرادمین</span>
      </a>

      <!-- Sidebar -->
      <div class="sidebar" style="direction: ltr">
        <div style="direction: rtl">
          <!-- Sidebar user panel (optional) -->
          <div class="user-panel mt-3 pb-3 mb-3 d-flex">
            <div class="image">
              <img src="/dist/img/khodam.png"
                class="img-circle elevation-2" alt="User Image" />
            </div>
            <div class="info">
              <a href="#" class="d-block">علیرضا خیاط‌پور</a>
            </div>
          </div>

          <!-- Sidebar Menu -->
          <nav class="mt-2">
            <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
              <!-- Add icons to the links using the .nav-icon class
                 with font-awesome or any other icon font library -->
              <li class="nav-item">
                <a href="/index.html" class="nav-link active">
                  <i class="nav-icon fa fa-dashboard"></i>
                  <p>
                    داشبورد
                    <!-- <i class="right fa fa-angle-left"></i> -->
                  </p>
                </a>
              </li>
              <li class="nav-item">
                <a href="./crudresturant.html" class="nav-link">
                  <i class="nav-icon fa fa-dashboard"></i>
                  <p>
                    لیست رستوران ها
                    <!-- <i class="right fa fa-angle-left"></i> -->
                  </p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/index2.html" class="nav-link">
                  <i class="nav-icon fa fa-dashboard"></i>
                  <p>
                    لیست سفارش ها
                    <!-- <i class="right fa fa-angle-left"></i> -->
                  </p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/index3.html" class="nav-link">
                  <i class="nav-icon fa fa-dashboard"></i>
                  <p>
                    لیست کاربران ها
                    <!-- <i class="right fa fa-angle-left"></i> -->
                  </p>
                </a>
              </li>
            </ul>
          </nav>
          <!-- /.sidebar-menu -->
        </div>
      </div>
      <!-- /.sidebar -->
    </aside>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
      <!-- Content Header (Page header) -->
      <section class="content-header">
        <div class="container-fluid">
          <div class="row mb-2">
            <div class="col-sm-6">
              <h1>ویرایش رستوران</h1>
            </div>
            <div class="col-sm-6">
              <ol class="breadcrumb float-sm-left">
                <li class="breadcrumb-item">
                  <a href="/index.html">خانه</a>
                </li>
                <li class="breadcrumb-item">
                  <a href="/pages/resturants/">رستوران ها</a>
                </li>
                <li class="breadcrumb-item active">ویرایش رستوران</li>
              </ol>
            </div>
          </div>
        </div>
        <!-- /.container-fluid -->
      </section>

      <!-- Main content -->
      <section class="content">
        <div class="container-fluid">
          <div class="row justify-content-center">
            <!-- left column -->
            <div class="col-md-8">
              <!-- general form elements -->
              <div class="card card-primary">
                <div class="card-header">
                  <h3 class="card-title">ویرایش رستوران</h3>
                </div>
                <!-- /.card-header -->
                <!-- form start -->
                <form role="form" onsubmit="return submitForm()">
                  <div class="card-body">
                    <div class="form-group">
                      <label for="name">نام رستوران</label>
                      <input type="text" class="form-control" id="name" placeholder="نام رستوران را وارد کنید" />
                    </div>
                    <div class="form-group">
                      <label for="desc">توضیحات</label>
                      <textarea type="text" class="form-control" id="desc" placeholder="توضیحات..."></textarea>
                    </div>
                    <div class="form-group">
                      <label for="adminMobile">موبایل ادمین</label>
                      <input type="text" class="form-control" id="adminMobile"
                        placeholder="موبایل ادمین را وارد کنید" />
                    </div>
                    <div class="form-group d-flex  align-items-end" id="password">
                      <div class="col-11">
                        <label for="adminPass">پسورد ادمین</label>
                        <input type="password" class="form-control adminPass " id="adminPass"
                          placeholder="پسورد ادمین را وارد کنید" />
                      </div>
                      <div class="col-1 toggle" onclick="showHide()">
                        <span class="fa fa-eye" id="eye"></span>
                        <span class="fa fa-eye-slash" id="eyeSlash"></span>
                      </div>

                    </div>

                    <div class="form-group">
                      <label for="address">آدرس</label>
                      <textarea type="text" class="form-control" id="address" placeholder="آدرس..."></textarea>
                    </div>
                  </div>
                  <!-- /.card-body -->

                  <div class="card-footer">
                    <button type="submit" class="btn btn-primary">
                      ویرایش رستوران
                    </button>
                  </div>
                </form>
              </div>
              <!-- /.card -->
            </div>
            <!--/.col (right) -->
          </div>
          <!-- /.row -->
        </div>
        <!-- /.container-fluid -->
      </section>
      <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->
    <footer class="main-footer">
      <strong>CopyLeft &copy; 2018
        <a href="http://github.com/hesammousavi/">علیرضا خیاط‌پور</a>.</strong>
    </footer>

    <!-- Control Sidebar -->
    <aside class="control-sidebar control-sidebar-dark">
      <!-- Control sidebar content goes here -->
    </aside>
    <!-- /.control-sidebar -->
  </div>
  <!-- ./wrapper -->



  <script src="../../plugins/jquery/jquery.min.js"></script>
  <!-- Bootstrap 4 -->
  <script src="../../plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="../../dist/js/demo.js"></script>


  <!--todo: Http Request To Server for get ResurantById -->

  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

  <script>
    //✍️ Step1: get id from QueryString in Url
    var urlparam = new URLSearchParams(location.search);
    const id = urlparam.get("id");
    console.log(id);

    //✍️ Step2: Send http request to Get resturant info from id that was got from Step1
    axios.get(`http://localhost:3000/api/superadmin/${id}`)
      .then(res => {
              console.log("res get resturant: ", res)
              //✍️ Step3 : put was got info from server into everyone inputs
              try {
                document.getElementById("name").value = res.data.name;
                document.getElementById("desc").value = res.data.desc;
                document.getElementById("adminMobile").value = res.data.adminMobile;
                document.getElementById("adminPass").value = res.data.adminPass;
                document.getElementById("address").value = res.data.address;
              } catch (err) {
                console.log("err1: ", err);
                
              }

      }).catch(err =>  console.log("err2: ", err.message))
     


    const submitForm = () => {
      try {
            const name = document.getElementById("name").value;
            const desc = document.getElementById("desc").value;
            const adminMobile = document.getElementById("adminMobile").value;
            const adminPass = document.getElementById("adminPass").value;
            const address = document.getElementById("address").value;
            if (!name || !desc || !adminMobile || !adminPass || !address) {
              alert("سوپر ادمین جان لطفا همه فیلد ها را پرکن تو دیگه چرا مهندس");
              return false; //for preventDefault refresh page
            }

            //todo Create object of input values
            const editResturant = {
              name,
              desc,
              adminMobile,
              adminPass,
              address,
            };
            console.log("editResturant: ", editResturant);

            axios.put(`http://localhost:3000/api/superadmin/${id}`, editResturant)
                .then((res) => {
                        console.log("res Post editResturant status 200", res);
                        alert(res.data.message);
                        window.location.assign("./cardresturant.html");
                      
                }).catch((err) => {
                      console.log("error res Post editResturant status 400 404 500: ", err);
                      alert(err.response.data.message); //to show response error message that send from server failed message
                });
                return false;
        } catch (err) {
          console.log("err3:",err,"خطایی از نوع همزمان sync uncaught Exception در بلاک کد ایجاد شده است");
          return false;
        }
    };

    //todo: Show/hidden Password
    function showHide() {
      let inputPass = document.querySelector(".adminPass")
      let toggle = document.querySelector(".toggle")
      //✍️ Tags in HTML nothing more than an object in Js
      if (inputPass.type === "password") {
        inputPass.setAttribute("type", "text")
        toggle.classList.add("hidde")
      } else {
        inputPass.setAttribute("type", "password")
        toggle.classList.remove("hidde")
      }
    }
  </script>
</body>

</html>