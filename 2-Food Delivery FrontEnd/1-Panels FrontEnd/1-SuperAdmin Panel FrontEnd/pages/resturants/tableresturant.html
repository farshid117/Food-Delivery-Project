<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>پنل سوپرادمین | جدول رستورا‌ها</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"
    />
    <!-- Ionicons -->
    <link
      rel="stylesheet"
      href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css"
    />
    <!-- DataTables -->
    <link
      rel="stylesheet"
      href="../../plugins/datatables/dataTables.bootstrap4.css"
    />
    <!-- Theme style -->
    <link rel="stylesheet" href="../../dist/css/adminlte.min.css" />
    <!-- Google Font: Source Sans Pro -->
    <link
      href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700"
      rel="stylesheet"
    />

    <!-- bootstrap rtl -->
    <link rel="stylesheet" href="../../dist/css/bootstrap-rtl.min.css" />
    <!-- template rtl version -->
    <link rel="stylesheet" href="../../dist/css/custom-style.css" />
  </head>
  <body class="hold-transition sidebar-mini">
    <div class="wrapper">
     
      <!-- Main Sidebar Container -->
      <aside class="main-sidebar sidebar-dark-primary elevation-4">
        <!-- Brand Logo -->
        <a href="/index.html" class="brand-link">
          <img
            src="/dist/img/logo3.png"
            alt="Logo"
            class="brand-image img-circle elevation-3"
            style="opacity: 0.8"
          />
          <span class="brand-text font-weight-light">پنل سوپرادمین</span>
        </a>

        <!-- Sidebar -->
        <div class="sidebar" style="direction: ltr">
          <div style="direction: rtl">
            <!-- Sidebar user panel (optional) -->
            <div class="user-panel mt-3 pb-3 mb-3 d-flex">
              <div class="image">
                <img
                  src="/dist/img/khodam.png"
                  class="img-circle elevation-2"
                  alt="User Image"
                />
              </div>
              <div class="info">
                <a href="#" class="d-block">علیرضا خیاط‌پور</a>
              </div>
            </div>

            <!-- Sidebar Menu -->
            <nav class="mt-2">
              <ul
                class="nav nav-pills nav-sidebar flex-column"
                data-widget="treeview"
                role="menu"
                data-accordion="false"
              >
                <!-- Add icons to the links using the .nav-icon class
                 with font-awesome or any other icon font library -->
                <li class="nav-item">
                  <a href="/index.html" class="nav-link ">
                    <i class="nav-icon fa fa-dashboard"></i>
                    <p>
                      داشبورد
                      <!-- <i class="right fa fa-angle-left"></i> -->
                    </p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="./crudresturant.html" class="nav-link active">
                    <i class="nav-icon fa fa-dashboard"></i>
                    <p>
                      لیست رستوران ها
                      <!-- <i class="right fa fa-angle-left"></i> -->
                    </p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/index2.html" class="nav-link">
                    <i class="nav-icon fa fa-dashboard"></i>
                    <p>
                      لیست سفارش ها
                      <!-- <i class="right fa fa-angle-left"></i> -->
                    </p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/index3.html" class="nav-link">
                    <i class="nav-icon fa fa-dashboard"></i>
                    <p>
                      لیست کاربران ها
                      <!-- <i class="right fa fa-angle-left"></i> -->
                    </p>
                  </a>
                </li>
              </ul>
            </nav>
            <!-- /.sidebar-menu -->
          </div>
        </div>
        <!-- /.sidebar -->
      </aside>

      <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
          <div class="container-fluid">
            <div class="row mb-2">
              <div class="col-sm-6">
                <h1>لیست رستوران ها</h1>
              </div>
              <div class="col-sm-6">
                <ol class="breadcrumb float-sm-left">
                  <li class="breadcrumb-item"><a href="#">خانه</a></li>
                  <li class="breadcrumb-item active">جداول رستوران ها</li>
                </ol>
              </div>
            </div>
          </div>
          <!-- /.container-fluid -->
        </section>

        <!-- Main content -->
        <section class="content">
          <div class="row">
            <div class="col-12">
              <div class="card">
                <div class="card-header row">
                  <h3 class="card-title">جدول رستوران ها</h3>
                  <button class="btn btn-info float-right mr-auto">
                    <a style="color: unset" href="/pages/resturants/create.html"
                      >رستوران جدید</a
                    >
                  </button>
                </div>
                <!-- /.card-header -->
                <div class="card-body">
                  <table id="example2" class="table table-bordered table-hover table-primary border-primary rounded align-middle">
                    <thead>
                      <tr class="table-active">
                        <th scope="col">نام رستوران</th>
                        <th scope="col">شماره رستوران</th>
                        <th scope="col">توضیحات</th>
                        <th scope="col">یوزرنیم ادمین</th>
                        <th scope="col">آدرس</th>
                        <th scope="col">ویرایش/حذف</th>
                      </tr>
                    </thead>
                    <tbody>


                    </tbody>
                  </table>
                </div>
                <!-- /.card-body -->
              </div>
              <!-- /.card -->
            </div>
            <!-- /.col -->
          </div>
          <!-- /.row -->
        </section>
        <!-- /.content -->
      </div>
      <!-- /.content-wrapper -->
      <footer class="main-footer">
        <strong
          >CopyLeft &copy; 2018
          <a href="http://github.com/hesammousavi/">علیرضاخیاط‌پور</a>.</strong
        >
      </footer>

      <!-- Control Sidebar -->
      <aside class="control-sidebar control-sidebar-dark">
        <!-- Control sidebar content goes here -->
      </aside>
      <!-- /.control-sidebar -->
    </div>
    <!-- ./wrapper -->

    <!-- jQuery -->
    <script src="../../plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="../../plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- DataTables -->
    <script src="../../plugins/datatables/jquery.dataTables.js"></script>
    <script src="../../plugins/datatables/dataTables.bootstrap4.js"></script>
    <!-- SlimScroll -->
    <script src="../../plugins/slimScroll/jquery.slimscroll.min.js"></script>
    <!-- FastClick -->
    <script src="../../plugins/fastclick/fastclick.js"></script>
    <!-- AdminLTE App -->
    <script src="../../dist/js/adminlte.min.js"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="../../dist/js/demo.js"></script>
    <!-- page script -->
    <script>
      $(function () {
        $("#example1").DataTable({
          language: {
            paginate: {
              next: "بعدی",
              previous: "قبلی",
            },
          },
          info: false,
        });
        $("#example2").DataTable({
          language: {
            paginate: {
              next: "بعدی",
              previous: "قبلی",
            },
          },
          info: false,
          paging: true,
          lengthChange: false,
          searching: false,
          ordering: true,
          autoWidth: false,
        });
      });
    </script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
      axios
        .get("http://localhost:3000/api/superadmin/")
        .then((res) => {
          try {
            console.log(res);
            // res is object with keys: data & header & statusCode 
            // that data's key include response of server that is array of resturants object
            let tbodyContent = res.data.map((item, index) =>
              
              `
                <tr>
                  <th scope="row">${index + 1}</th>  
                  <td>${item.name}</td>  
                  <td>${item.desc}</td>  
                  <td>${item.adminUsername}</td>  
                  <td>${item.address}</td> 
                  <td class="d-flex">
                    <a class="btn btn-primary btn-sm ml-1" href="./edit.html?id=${item._id}"> ویرایش </a>
                    <button onclick= "deleteResturant('${item._id}')" class="btn btn-danger btn-sm">حذف</button>
                    </td>
                    </tr>
                    `
                    /*  <button onclick="window.location.assign('./edit.html?id=${item._id}&name=${item.name}&desc=${item.desc}&adminUsername=${item.adminUsername}&adminPass=${item.adminPass}&address=${item.address}')"  class="btn-sm btn-primary ml-1">ویرایش</button> */
           
            )
              ; //todo: change array to string
              console.log("tebodyContent :", tbodyContent.join(""));
              document.querySelector("tbody").innerHTML = tbodyContent.join("")
          } catch (err) {
            console.log(err)
          }
        })
        .catch((err) => {
          console.log(err);
        });


      const deleteResturant= (id) =>{
        let result = confirm("سوپر ادمین جان آیا مطمئنی که میخوای رستوران را حذف کنی؟")
        if(result){
          axios.delete(`http://localhost:3000/api/superadmin/${id}`)
          .then(res =>{
            alert("رستوران حذف شد")
            window.location.assign("./crudresturant.html")
          })
          .catch(err => console.log(err.message))
        }
      }
    </script>
  </body>
</html>
